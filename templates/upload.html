{% extends "base.html" %}
{% block title %}시간표 업로드 - Timetable Dashboard{% endblock %}

{% block content %}
<div class="max-w-2xl mx-auto">
    <div class="mb-6">
        <h1 class="text-2xl font-bold text-gray-800">시간표 업로드</h1>
        <p class="text-sm text-gray-500 mt-1">엑셀 파일에서 수업 일정을 가져옵니다.</p>
    </div>

    <!-- Step 1: 파일 업로드 -->
    <div id="step1" class="bg-white rounded-lg shadow-sm p-6 border border-gray-200 mb-4">
        <div class="flex items-center space-x-2 mb-4">
            <div class="w-7 h-7 rounded-full bg-primary text-white flex items-center justify-center text-sm font-bold">1</div>
            <h2 class="text-lg font-semibold text-gray-700">엑셀 파일 선택</h2>
        </div>
        <div id="drop-zone"
             class="border-2 border-dashed border-gray-300 rounded-lg p-8 text-center hover:border-primary transition-colors cursor-pointer">
            <svg class="mx-auto h-12 w-12 text-gray-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                      d="M7 16a4 4 0 01-.88-7.903A5 5 0 1115.9 6L16 6a5 5 0 011 9.9M15 13l-3-3m0 0l-3 3m3-3v12"/>
            </svg>
            <p class="mt-2 text-sm text-gray-600">클릭하거나 파일을 드래그해서 업로드</p>
            <p class="text-xs text-gray-400 mt-1">.xlsx 파일만 지원됩니다</p>
            <input type="file" id="file-input" accept=".xlsx,.xls" class="hidden">
        </div>
        <div id="file-info" class="hidden mt-3 p-3 bg-blue-50 rounded-lg flex items-center justify-between">
            <div class="flex items-center space-x-2">
                <svg class="w-5 h-5 text-primary" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                          d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"/>
                </svg>
                <span id="file-name" class="text-sm font-medium text-gray-700"></span>
            </div>
            <button id="remove-file" class="text-gray-400 hover:text-red-500">
                <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"/>
                </svg>
            </button>
        </div>
        <div id="upload-progress" class="hidden mt-3">
            <div class="w-full bg-gray-200 rounded-full h-2">
                <div id="progress-bar" class="bg-primary h-2 rounded-full transition-all duration-300" style="width: 0%"></div>
            </div>
            <p id="progress-text" class="text-xs text-gray-500 mt-1">업로드 중...</p>
        </div>
    </div>

    <!-- Step 2: 시트 선택 -->
    <div id="step2" class="hidden bg-white rounded-lg shadow-sm p-6 border border-gray-200 mb-4">
        <div class="flex items-center space-x-2 mb-4">
            <div class="w-7 h-7 rounded-full bg-primary text-white flex items-center justify-center text-sm font-bold">2</div>
            <h2 class="text-lg font-semibold text-gray-700">시트 선택</h2>
        </div>
        <p class="text-sm text-gray-500 mb-3">가져올 월(시트)을 선택하세요.</p>
        <div class="flex gap-2 mb-3">
            <button id="select-all" class="text-xs px-3 py-1 bg-gray-100 hover:bg-gray-200 rounded-md text-gray-600 transition-colors">전체 선택</button>
            <button id="deselect-all" class="text-xs px-3 py-1 bg-gray-100 hover:bg-gray-200 rounded-md text-gray-600 transition-colors">전체 해제</button>
        </div>
        <div id="sheet-list" class="grid grid-cols-3 sm:grid-cols-4 gap-2">
            <!-- JS로 동적 생성 -->
        </div>
    </div>

    <!-- Step 3: 과정 설정 -->
    <div id="step3" class="hidden bg-white rounded-lg shadow-sm p-6 border border-gray-200 mb-4">
        <div class="flex items-center space-x-2 mb-4">
            <div class="w-7 h-7 rounded-full bg-primary text-white flex items-center justify-center text-sm font-bold">3</div>
            <h2 class="text-lg font-semibold text-gray-700">과정 설정</h2>
        </div>
        <div class="space-y-4">
            <div>
                <label class="block text-sm font-medium text-gray-700 mb-1">과정명</label>
                <input type="text" id="course-name"
                       class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-primary focus:border-transparent text-sm"
                       placeholder="예: AI School 8기">
            </div>
            <div>
                <label class="block text-sm font-medium text-gray-700 mb-1">색상</label>
                <div id="color-picker" class="flex flex-wrap gap-2">
                    <!-- JS로 동적 생성 -->
                </div>
            </div>
            <div>
                <label class="block text-sm font-medium text-gray-700 mb-1">기본 수업 시작 시각</label>
                <input type="time" id="start-time" value="09:00"
                       class="px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-primary focus:border-transparent text-sm">
            </div>
        </div>
    </div>

    <!-- 가져오기 버튼 -->
    <div id="import-section" class="hidden">
        <button id="import-btn"
                class="w-full py-3 px-4 bg-primary hover:bg-blue-600 text-white font-medium rounded-lg transition-colors text-sm disabled:opacity-50 disabled:cursor-not-allowed"
                disabled>
            시간표 가져오기
        </button>
    </div>

    <!-- 결과 메시지 -->
    <div id="result-message" class="hidden mt-4 p-4 rounded-lg">
        <p id="result-text" class="text-sm font-medium"></p>
    </div>
</div>
{% endblock %}

{% block scripts %}
<script src="{{ url_for('static', filename='js/upload.js') }}"></script>
{% endblock %}
